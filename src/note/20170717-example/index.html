<!doctype html>
<html>
<head>
  <title>List of Countries</title>
  <style>
    body    { padding: 0 2em; margin: 0 auto; max-width: 800px }
    table   { width: 100%; }
    th      { text-align: left; text-transform: uppercase }
    tbody > tr:nth-child(odd) { background-color: gainsboro }
    .shadow { text-shadow: grey 2px 3px 3px }
  </style>
</head>
<body></body>
<script>
function h(element = 'div', classes, children) {
  const el = document.createElement(element)

  if (Array.isArray(classes)) {
    classes.forEach(clss => el.classList.add(clss))
  } else if (typeof classes === 'string') {
    el.classList.add(classes)
  }

  if (Array.isArray(children)) {
    children.forEach(child => child instanceof HTMLElement && el.append(child))
  } else if (children instanceof HTMLElement) {
    el.append(children)
  } else if (typeof children === 'string') {
    el.innerText = children
  }

  return el
}

const columnNames = key =>
  ['name', 'capital', 'subregion', 'population'].indexOf(key) > -1

const Title = () => 
  h('h2', 'shadow', document.title)

const Thead = columns =>
  h('thead', null, 
    h('tr', null, 
      columns.filter(columnNames).map(column => 
        h('th', null, column))))

const Tbody = data =>
  h('tbody', null,data.map(row =>
    h('tr', null, 
      Object.keys(row).filter(columnNames).map(key => 
        h('td', null, key === 'population' ? row[key].toLocaleString() : row[key])))))

const Table = data =>
  h('table', 'table', [
    Thead(Object.keys(data[0])),
    Tbody(data)])

async function main() {
  const app = document.querySelector('body')
  const response = await fetch('https://restcountries.eu/rest/v2/all')
  const data = await response.json()
  app.appendChild(Title())
  app.appendChild(Table(data))
}

main()
</script>
</html>
